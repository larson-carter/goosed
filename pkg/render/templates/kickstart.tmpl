# Kickstart generated by goosed API
lang en_US.UTF-8
keyboard us
timezone UTC --isUtc
network --bootproto=dhcp{{with $hostname := index .Profile "hostname"}} --hostname={{$hostname}}{{end}}

%packages
@^minimal
chrony
{{- with $packages := index .Profile "packages" }}
{{- range $pkg := $packages }}
{{$pkg}}
{{- end }}
{{- end }}
%end

%post
set -eux

echo "Provisioned machine {{.Machine.ID}} (MAC {{.Machine.MAC}})" > /root/provisioned
curl -fsSL {{ .AgentInstallURL }} | bash -s -- --api {{ .APIBase }} --token {{ .Token }} --machine {{ .Machine.ID }}
%end
